<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Layouts for officer's PowerPoint documents. • customLayout</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><script src="../extra.js"></script><meta property="og:title" content="Layouts for officer's PowerPoint documents.">
<meta property="og:description" content="customLayout">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">customLayout</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Intro</a>
</li>
<li>
  <a href="../articles/Roadmap.html">Roadmap</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/customlayout-cookbook.html">Cookbook</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/layouts-for-officer-power-point-document.html">Layouts for officer's PowerPoint documents.</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/zzawadz/customLayout/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="layouts-for-officer-power-point-document_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Layouts for officer’s PowerPoint documents.</h1>
                        <h4 class="author">Zygmunt Zawadzki</h4>
            
            <h4 class="date">2021-01-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zzawadz/customLayout/blob/master/vignettes/layouts-for-officer-power-point-document.Rmd"><code>vignettes/layouts-for-officer-power-point-document.Rmd</code></a></small>
      <div class="hidden name"><code>layouts-for-officer-power-point-document.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This document shows how to work with PowerPoint files in R using customLayout approach.</p>
<p>Let’s start by creating a layout. <code>lay</code> and <code>lay2</code> will be used to store the content of the slide (plots, tables, text), and <code>titleLay</code> will serve as a container for the title of the slide.</p>
<p>It seems that merging the title placeholder in the last step allows to the easy control its ratio to the content of the slide. Note that <code>titleLay</code> is merged with <code>lay3</code> (combination of <code>lay</code> and <code>lay2</code>) using a ratio 1:7, so the content of the slide will occupy about 87,5% of the area (<code>7/(1+7)</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.customlayout.zstat.pl/">customLayout</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ardata-fr.github.io/officeverse/">officer</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>

<span class="va">lay</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_new.html">lay_new</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,nc<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>,heights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">lay2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_new.html">lay_new</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">titleLay</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_new.html">lay_new</a></span><span class="op">(</span><span class="fl">1</span>, widths <span class="op">=</span> <span class="fl">1</span>, heights <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">lay3</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_bind_col.html">lay_bind_col</a></span><span class="op">(</span><span class="va">lay</span>,<span class="va">lay2</span>, widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">layout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_bind_row.html">lay_bind_row</a></span><span class="op">(</span><span class="va">titleLay</span>, <span class="va">lay3</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/lay_show.html">lay_show</a></span><span class="op">(</span><span class="va">layout</span><span class="op">)</span></code></pre></div>
<p><img src="layouts-for-officer-power-point-document_files/figure-html/unnamed-chunk-1-1.png" width="700"></p>
<p>In the next step, one needs to create an officer layout from an existing <code>layout</code> object. It is done by calling <code>phl_layout</code>, which allows specifying the target size of the slide and margins.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## create officer layout</span>
<span class="va">offLayout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_layout.html">phl_layout</a></span><span class="op">(</span><span class="va">layout</span>,
    margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>,
    innerMargins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.15</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="ggplot2" class="section level2">
<h2 class="hasAnchor">
<a href="#ggplot2" class="anchor"></a><code>ggplot2</code>
</h2>
<p>Then, the elements of the slide are added using functions with <code>phl_*</code> prefix. The code below adds two ggplot plots into the slide using <code>phl_with_gg</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_pptx.html">read_pptx</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/officer/reference/add_slide.html">add_slide</a></span><span class="op">(</span>master <span class="op">=</span> <span class="st">"Office Theme"</span>, layout <span class="op">=</span> <span class="st">"Title and Content"</span><span class="op">)</span>

<span class="co">### fill first placeholder</span>

<span class="va">plot1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">wt</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>
<span class="va">plot3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/qplot.html">qplot</a></span><span class="op">(</span><span class="va">mpg</span>, <span class="va">qsec</span>, data <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span>
<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_gg.html">phl_with_gg</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">2</span>, <span class="va">plot1</span><span class="op">)</span>
<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_gg.html">phl_with_gg</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">4</span>, <span class="va">plot3</span><span class="op">)</span></code></pre></div>
<p><img src="power-point/officer-gg.png"></p>
</div>
<div id="base-graphics" class="section level2">
<h2 class="hasAnchor">
<a href="#base-graphics" class="anchor"></a>Base graphics</h2>
<p>It is also worth to note that pptx files allow intermixing base graphics with grid graphics (ggplot2 and friends). The example below adds a few pie charts (note from the author - I’m not a fan of pie charts. Please don’t use them on real slides). In this case <code>phl_with_plot</code> requires a function which creates a plot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pl5</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/pie.html">pie</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">pl6</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/pie.html">pie</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">7</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span> <span class="op">+</span> <span class="fl">3</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">pl7</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/pie.html">pie</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span> <span class="op">+</span> <span class="fl">6</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_plot.html">phl_with_plot</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">6</span>, <span class="va">pl5</span><span class="op">)</span>
<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_plot.html">phl_with_plot</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">7</span>, <span class="va">pl6</span><span class="op">)</span>
<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_plot.html">phl_with_plot</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">8</span>, <span class="va">pl7</span><span class="op">)</span></code></pre></div>
<p><img src="power-point/officer-plots.png"></p>
</div>
<div id="basic-tables" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-tables" class="anchor"></a>Basic tables</h2>
<p>To export data.frame to the slide, one needs to use <code>phl_with_table</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_table.html">phl_with_table</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>Note, that in the current version <code>customLayout</code> is not able to fit the table perfectly to your slide. The desired width will be matched at the expense of the table height and text-wrapping. See the output slide created from the code above. As you can see, the table is a bit too tall, and the texts in cells are inelegantly wrapped.</p>
<p><img src="power-point/officer-table.png"></p>
</div>
<div id="text" class="section level2">
<h2 class="hasAnchor">
<a href="#text" class="anchor"></a>Text</h2>
<p>Inserting the text works in a very similar fashion to the officer package, just use the <code>phl_with_text</code> function. To add the formatting to the text use the <code>style</code> argument as in the example below (<code>phl_with_text</code> internally uses <code><a href="https://davidgohel.github.io/officer/reference/ph_add_text.html">officer::ph_add_text</a></code>).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_text.html">phl_with_text</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">1</span>, <span class="st">"Custom Layout"</span><span class="op">)</span>

<span class="va">style</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_text.html">fp_text</a></span><span class="op">(</span>font.size <span class="op">=</span> <span class="fl">24</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="va">pptx</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_text.html">phl_with_text</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">offLayout</span>, <span class="fl">5</span>, 
          <span class="st">"Lorem ipsum"</span>, type <span class="op">=</span> <span class="st">"body"</span>, style <span class="op">=</span> <span class="va">style</span><span class="op">)</span></code></pre></div>
<p><img src="power-point/officer-text.png"></p>
</div>
<div id="render-document" class="section level2">
<h2 class="hasAnchor">
<a href="#render-document" class="anchor"></a>Render document</h2>
<p>To render document use the standard <code>print</code> function from <code>officer</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".pptx"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">pptx</span>, <span class="va">file</span><span class="op">)</span></code></pre></div>
</div>
<div id="flextables" class="section level2">
<h2 class="hasAnchor">
<a href="#flextables" class="anchor"></a><code>flextable</code>s</h2>
<div id="getting-started" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h3>
<p>To get more control over created tables, one can use the <code>flextable</code> package (<a href="https://davidgohel.github.io/flextable/index.html" class="uri">https://davidgohel.github.io/flextable/index.html</a>), which is also supported by the <code>customLayout</code> by the <code>phl_with_flextable</code> function.</p>
<p>Let’s start with preparing the layout and sample data.frame for further examples:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.customlayout.zstat.pl/">customLayout</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://davidgohel.github.io/flextable/">flextable</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ardata-fr.github.io/officeverse/">officer</a></span><span class="op">)</span>

<span class="va">lay</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_new.html">lay_new</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,nc<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>,heights<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="va">lay2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_new.html">lay_new</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">layout</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lay_bind_col.html">lay_bind_col</a></span><span class="op">(</span><span class="va">lay</span>,<span class="va">lay2</span>, widths<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/lay_show.html">lay_show</a></span><span class="op">(</span><span class="va">layout</span><span class="op">)</span></code></pre></div>
<p><img src="layouts-for-officer-power-point-document_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="va">offLayout</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_layout.html">phl_layout</a></span><span class="op">(</span><span class="va">layout</span>,
    margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span><span class="op">)</span>,
    innerMargins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0.15</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>

<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_pptx.html">read_pptx</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/officer/reference/add_slide.html">add_slide</a></span><span class="op">(</span>master <span class="op">=</span> <span class="st">"Office Theme"</span>, layout <span class="op">=</span> <span class="st">"Title and Content"</span><span class="op">)</span>

<span class="va">table</span> <span class="op">&lt;-</span> <span class="va">mtcars</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>Mean <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">qsec</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span></code></pre></div>
</div>
<div id="simple-flextable" class="section level3">
<h3 class="hasAnchor">
<a href="#simple-flextable" class="anchor"></a>Simple <code>flextable</code>
</h3>
<p>To add the <code>flextable</code> to the slide, one needs to convert the data. frame to the <code>flextable</code> object. Then the function <code>phl_with_flextable</code> can be used:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_pptx.html">read_pptx</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/officer/reference/add_slide.html">add_slide</a></span><span class="op">(</span>
    master <span class="op">=</span> <span class="st">"Office Theme"</span>,
    layout <span class="op">=</span> <span class="st">"Title and Content"</span><span class="op">)</span>

<span class="va">flTableRaw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html">flextable</a></span><span class="op">(</span><span class="va">table</span><span class="op">)</span>
<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_flextable.html">phl_with_flextable</a></span><span class="op">(</span><span class="va">pptx</span>, 
      olay <span class="op">=</span> <span class="va">offLayout</span>, <span class="fl">1</span>, <span class="va">flTableRaw</span><span class="op">)</span></code></pre></div>
<p><img src="power-point/officer-flraw.png"></p>
</div>
<div id="fit-the-table-to-the-placeholder" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-the-table-to-the-placeholder" class="anchor"></a>Fit the table to the placeholder</h3>
<p>However, the <code>phl_with_flextable</code> does not modify any parameters of the table and writes it to the pptx as is. It means that the user needs to specify the correct font size, the widths, and heights for columns and rows. It might be quite hard to do, but the <code>customLayout</code> provides the <code>phl_adjust_table</code> function which takes a data.frame as an argument and tries to find as large font size, widths and heights as possible for given placeholder in the layout. Note that this function uses some simple heuristics, and might not always work as expected, and some manual tuning will be required.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_pptx.html">read_pptx</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/officer/reference/add_slide.html">add_slide</a></span><span class="op">(</span>
    master <span class="op">=</span> <span class="st">"Office Theme"</span>,
    layout <span class="op">=</span> <span class="st">"Title and Content"</span><span class="op">)</span>

<span class="va">flTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_adjust_table.html">phl_adjust_table</a></span><span class="op">(</span><span class="va">table</span>, olay <span class="op">=</span> <span class="va">offLayout</span>, id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_flextable.html">phl_with_flextable</a></span><span class="op">(</span><span class="va">pptx</span>, 
      olay <span class="op">=</span> <span class="va">offLayout</span>, <span class="fl">1</span>, <span class="va">flTable</span><span class="op">)</span></code></pre></div>
<p><img src="power-point/officer-fltable.png"></p>
</div>
<div id="formatted-flextable" class="section level3">
<h3 class="hasAnchor">
<a href="#formatted-flextable" class="anchor"></a>Formatted <code>flextable</code>
</h3>
<p>After calling the <code>phl_adjust_table</code> one can modify the table in any way. Go to the <a href="https://davidgohel.github.io/flextable/articles/overview.html" class="uri">https://davidgohel.github.io/flextable/articles/overview.html</a> for more examples.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_pptx.html">read_pptx</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/officer/reference/add_slide.html">add_slide</a></span><span class="op">(</span>
    master <span class="op">=</span> <span class="st">"Office Theme"</span>,
    layout <span class="op">=</span> <span class="st">"Title and Content"</span><span class="op">)</span>

<span class="va">flTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_adjust_table.html">phl_adjust_table</a></span><span class="op">(</span><span class="va">table</span>, olay <span class="op">=</span> <span class="va">offLayout</span>, id <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="va">flTable</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/bg.html">bg</a></span><span class="op">(</span><span class="va">flTable</span>, bg <span class="op">=</span> <span class="st">"#E4C994"</span>, part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span>
<span class="va">flTable</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/bg.html">bg</a></span><span class="op">(</span><span class="va">flTable</span>, bg <span class="op">=</span> <span class="st">"#333333"</span>, part <span class="op">=</span> <span class="st">"body"</span><span class="op">)</span>
<span class="va">flTable</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/color.html">color</a></span><span class="op">(</span><span class="va">flTable</span>, color <span class="op">=</span> <span class="st">"#E4C994"</span><span class="op">)</span>

<span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_with_flextable.html">phl_with_flextable</a></span><span class="op">(</span><span class="va">pptx</span>, 
      olay <span class="op">=</span> <span class="va">offLayout</span>, <span class="fl">1</span>, <span class="va">flTable</span><span class="op">)</span></code></pre></div>
<p><img src="power-point/officer-flff.png"></p>
</div>
<div id="fit-the-table-to-the-placeholder---part-ii" class="section level3">
<h3 class="hasAnchor">
<a href="#fit-the-table-to-the-placeholder---part-ii" class="anchor"></a>Fit the table to the placeholder - part II</h3>
<p>The example below shows the appearance of the table in each placeholder of the layout. It seems that it works reasonably well.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pptx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/read_pptx.html">read_pptx</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://davidgohel.github.io/officer/reference/add_slide.html">add_slide</a></span><span class="op">(</span>
    master <span class="op">=</span> <span class="st">"Office Theme"</span>,
    layout <span class="op">=</span> <span class="st">"Title and Content"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">offLayout</span><span class="op">)</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">tbl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/phl_adjust_table.html">phl_adjust_table</a></span><span class="op">(</span><span class="va">table</span>, <span class="va">offLayout</span>, <span class="va">i</span><span class="op">)</span>  
  <span class="fu"><a href="../reference/phl_with_flextable.html">phl_with_flextable</a></span><span class="op">(</span><span class="va">pptx</span>, olay <span class="op">=</span> <span class="va">offLayout</span>, <span class="va">i</span>, <span class="va">tbl</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
<p><img src="power-point/officer-flall.png"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zygmunt Zawadzki.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
